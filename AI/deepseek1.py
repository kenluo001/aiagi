'''
Author: error: git config user.name & please set dead value or install git
Email: error: git config user.email & please set dead value or install git
Date: 2025-02-25 17:27:17
FilePath: /aiagi/AI/deepseek1.py
'''
from openai import OpenAI
import config 

client = OpenAI(
    api_key=config.config_data['api_key'], 
    base_url="https://api.deepseek.com")

response = client.chat.completions.create(
    model="deepseek-chat",
    # model='deepseek-reasoner',
    messages=[
    {
        "role": "system",
        "content": "## 角色 智能风控审计官，擅长通过对话内容精准识别诈骗行为以及行业不一致。"
                  "## 任务目标1. 分析对话上下文，准确区分「客户」和「坐席」角色。2. 仅依据对话内容判断是否符合特征，禁止主观猜测。"
                  "## 分析原则- 必须基于对话实际内容进行判断，角色身份以对话内容反推。- 当对话中出现多轮次交叉发言时，需结合上下文确认发言归属。- 排除来电提示音、语音助理等非实质性对话内容干扰。"
                  "## 风险标签判定标准**优先级排序**：诈骗检测 > 行业一致性检测符合以下特征即标注【诈骗】："
                  "1. **身份冒充**：自称公检法/军队/客服/领导等特殊身份。"
                  "2. **紧急事件**：虚构家人事故/包裹丢失/涉嫌犯罪等紧急场景。"
                  "3. **利益诱导**：承诺中奖/高回报投资/免息贷款等金钱诱惑。"
                  "4. **异常指令**：要求下载不明APP/点击链接/屏幕共享等操作。"
                  "5. **资金操作**：引导转账/索要验证码/要求垫付资金等行为。"
                  "符合以下特征即标注【行业不一致】："
                  "1. **动态术语库构建**:- 根据生成三维特征词库：- **核心术语**（强关联词，如教育行业的:课程/学分/教案\"） - **衍生术语**（弱关联词，如教育行业的在线学习/教学大纲\"）。 - **排除术语**（冲突行业词，如金融行业的\"利率/理财产品"
                  "2. **语义级置信度计算**：   - 采用词向量相似度分析： - 匹配1个核心术语 → 基础分 +0.5。     - 匹配1个衍生术语 → 基础分 +0.3。     "
                  "- 出现排除术语 → 直接触发【业务不一致】。   - 最终置信度 = Σ(术语得分) × 上下文语义连贯系数（0.8-1.2）。"
                  "3. **智能判决**：   - 置信度 ≥ 0.7 → 业务合规。   - 置信度 < 0.7 → 触发【业务不一致】。"
                  "## 输出协议1. 仅允许输出 `\"诈骗\"` 或 `\"业务不一致\"` 或 `\"无\"` 三种标签。"
                  "2. 严格使用以下 JSON 格式，禁止添加说明：   ```json   {\"风险标签\":\"<判定结果>\"} ```**执行示例：**案例1：对话内容："
                   "A：\"我是公安局刑侦科的，你的账户涉嫌洗钱\""
                   "B：\"请立即将资金转入安全账户XXXX\"→ 输出：`{\"风险标签\":\"诈骗\"}`"
                   "案例2：参数：industry=education对话内容：用户：\"我想咨询下你们这款年金保险的缴费方式\"坐席：\"该产品支持10年分期缴付保费\"→ "
                   "输出：`{\"风险标签\":\"业务不一致\"}`[判定依据]1. 检测到保险行业强特征词\"年金保险\"、\"缴费\"、\"保费\"。"
                   "2. 与教育行业词库零匹配。3. 置信度 = 0（核心术语匹配数） × 1.0 = 0 < 0.7。请分析以下对话内容：座席：\"您好，我是公安局的，您的账户涉嫌洗钱，请立即将资金转入安全账户。\""},
     {
      "role": "assistant",
      "content": "您好，是*吗？我是快递的客服。"
    },
    {
      "role": "user",
      "content": "是的，请问有什么事？"
    },
    {
      "role": "assistant",
      "content": "非常抱歉，由于快递小哥的失误，您的快递单号为*****的包裹丢失了。您能核实一下购买的商品和价格吗？我们会进行赔偿。"
    },
    {
      "role": "user",
      "content": "我买的是一台手机，价格是5000元。"
    },
    {
      "role": "assistant",
      "content": "好的，我们会对您全额赔偿。为了尽快处理，请您加我们的QQ客服号******，我们会通过QQ指导您完成赔偿流程。"
    },
    {
      "role": "user",
      "content": "好的，我加一下。"
    }
    ],
    stream=False

)

print(response.choices[0].message.content)